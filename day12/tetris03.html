<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
<script type="text/javascript">
	
	var block2D = [
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],

		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0]
	];
	
	var stack2D = [
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[3,3,3,3,3, 3,3,3,0,0]
	];
	
	var scrin2D = [
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		                      
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0],
		[0,0,0,0,0, 0,0,0,0,0]
	];
	
	class Block {
		  constructor(type,status,i,j) {
		    this.type = type;
		    this.status = status;
		    this.i = i;
		    this.j = j;
		  }
	
	}
	var b = new Block(7,1,2,2);
	
	function setBlock2DFromClass(){
		
		for(var i=0; i<block2D.length; i++) {
			for(var j=0; j<block2D[j].length; j++) {
				if(block2D[i][j]>0) {
					block2D[i][j] = 0;
				}
			}
		}
		
		if(b.type == 1){
			block2D[b.i		][b.j	]=b.type;
			block2D[b.i		][b.j+1	]=b.type;
			block2D[b.i+1	][b.j	]=b.type;
			block2D[b.i+1	][b.j+1	]=b.type;
		}
		
		if(b.type == 2){
			if(b.status == 1){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i+1	][b.j+1	]=b.type;
			}	
			if(b.status == 2){
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i+1	][b.j-1	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
			}	
		}
		
		if(b.type == 3){
			if(b.status == 1){
				block2D[b.i-1	][b.j+1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
			}	
			if(b.status == 2){
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
				block2D[b.i+1	][b.j+1	]=b.type;
			}	
		}
		
		if(b.type == 4){
			if(b.status == 1){
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i		][b.j+2	]=b.type;
			}	
			if(b.status == 2){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
				block2D[b.i+2	][b.j	]=b.type;
			}	
		}
		
		if(b.type == 5){
			if(b.status == 1){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i-1	][b.j+1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
			}	
			if(b.status == 2){
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i+1	][b.j+1	]=b.type;
			}	
			if(b.status == 3){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
				block2D[b.i+1	][b.j-1	]=b.type;
			}	
			if(b.status == 4){
				block2D[b.i-1	][b.j-1	]=b.type;
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
			}	
		}
		
		if(b.type == 6){
			if(b.status == 1){
				block2D[b.i-1	][b.j-1	]=b.type;
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
			}	
			if(b.status == 2){
				block2D[b.i-1	][b.j+1	]=b.type;
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
			}	
			if(b.status == 3){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
				block2D[b.i+1	][b.j+1	]=b.type;
			}	
			if(b.status == 4){
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i+1	][b.j-1	]=b.type;
			}	
		}
		
		if(b.type == 7){
			if(b.status == 1){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
			}	
			if(b.status == 2){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
			}	
			if(b.status == 3){
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i		][b.j+1	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
			}	
			if(b.status == 4){
				block2D[b.i-1	][b.j	]=b.type;
				block2D[b.i		][b.j-1	]=b.type;
				block2D[b.i		][b.j	]=b.type;
				block2D[b.i+1	][b.j	]=b.type;
			}	
		}
		
	}
	
	function moveBlock2DToScrin2D() {
		for(var i=0; i<block2D.length; i++) {
			for(var j=0; j<block2D[i].length; j++) {
				if(block2D[i][j]>0){
					scrin2D[i][j] = block2D[i][j];
				}
			}
		}
	}
	
	function moveStack2DToScrin2D() {
		for(var i=0; i<stack2D.length; i++) {
			for(var j=0; j<stack2D[i].length; j++) {
				if(stack2D[i][j]>0) {
					scrin2D[i][j] = stack2D[i][j];
				}
			}
		}
	}
	
	function myrender() {
		var tds = document.getElementsByTagName("td");
		
		for(var i=0; i<scrin2D.length; i++) {
			for(var j=0; j<scrin2D[i].length; j++) {
				if(scrin2D[i][j] == 0) {
					tds[i*10+j].bgColor = "#ffffff";
				}
				
				if(scrin2D[i][j] == 1) {
					tds[i*10+j].bgColor = "#ff0000";
				}
				if(scrin2D[i][j] == 2) {
					tds[i*10+j].bgColor = "#dd0000";
				}
				if(scrin2D[i][j] == 3) {
					tds[i*10+j].bgColor = "#bb0000";
				}
				if(scrin2D[i][j] == 4) {
					tds[i*10+j].bgColor = "#990000";
				}
				if(scrin2D[i][j] == 5) {
					tds[i*10+j].bgColor = "#770000";
				}
				if(scrin2D[i][j] == 6) {
					tds[i*10+j].bgColor = "#550000";
				}
				if(scrin2D[i][j] == 7) {
					tds[i*10+j].bgColor = "#330000";
				}
				
				if(scrin2D[i][j] == 11) {
					tds[i*10+j].bgColor = "#00ff00";
				}
				if(scrin2D[i][j] == 12) {
					tds[i*10+j].bgColor = "#00dd00";
				}
				if(scrin2D[i][j] == 13) {
					tds[i*10+j].bgColor = "#00bb00";
				}
				if(scrin2D[i][j] == 14) {
					tds[i*10+j].bgColor = "#009900";
				}
				if(scrin2D[i][j] == 15) {
					tds[i*10+j].bgColor = "#007700";
				}
				if(scrin2D[i][j] == 16) {
					tds[i*10+j].bgColor = "#005500";
				}
				if(scrin2D[i][j] == 17) {
					tds[i*10+j].bgColor = "#003300";
				}
				
	
			}
		}
		
	}
	
	function makeScrin2DZero() {
		for(var i=0; i<scrin2D.length; i++) {
			for(var j=0; j<scrin2D[j].length; j++) {
					scrin2D[i][j] = 0;
			}
		}
	}
	
	function changeStatus() {
		if (b.type == 2 || b.type == 3 || b.type == 4) {
			if (b.status == 1) {
				b.status = 2;
			}else if (b.status == 2){
				b.status = 1;
			}
		}
		if (b.type == 5 || b.type == 6 || b.type == 7) {
			if (b.status == 4) {
				b.status = 1;
			}else {
				b.status++;
			}
		}
	}
	
	function isCollision(){
		
		var cnt = 0;
		for(var i=0; i<25; i++) {
			for(var j=0; j<10; j++) {
				if(block2D[i][j]>0) {
					cnt ++;
				}
			}
		}
		if(cnt<4){
			return true;
		}
		
		for(var i=0; i<block2D.length; i++) {
			for(var j=0; j<block2D[i].length; j++) {
				if(block2D[i][j]>0 && stack2D[i][j]>0) {
					return true;
				}
			}
		}
			
		return false;
	}
	
	function mydown(key) {
		var bak_type 	= b.type;
		var bak_status  = b.status;
		var bak_i 		= b.i;
		var bak_j 		= b.j;
		
		if(key == "ArrowUp") {
			changeStatus();
		}
		if(key == "ArrowDown") {
			b.i++;
		}
		if(key == "ArrowRight") {
			b.j++;
		}
		if(key == "ArrowLeft") {
			b.j--;
		}
		
		setBlock2DFromClass();
		
		var flag_collision = isCollision();
		console.log("flag_collision:"+flag_collision);
		
		makeScrin2DZero();
		moveBlock2DToScrin2D();
		moveStack2DToScrin2D();
		
		
		myrender();
		
// 		console.log(block2D);
// 		console.log(scrin2D);
		
	}
	
	window.addEventListener("keydown", (e) => {
		mydown(e.key);
		
	});
	
</script>
<style type="text/css">
table{
	border : 0px;
	margin : 0px;
	padding : 0px;
}
tr{
	border : 0px;
	margin : 0px;
	padding : 0px;
}
td{
	width : 10px;
	height : 10px;
}
</style>
</head>
<body>

<table border="1px">
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	<tr> <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td> </tr>
	
</table>

</body>
</html>